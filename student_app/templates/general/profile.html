{% extends 'base.html' %}
{% load static %}

{% block title %}Profile | Sikshya Kendra{% endblock %}

{% block content %}
<div class="profile-container">
    <!-- Profile Header -->
    <div class="profile-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="profile-info">
                        <div class="profile-avatar">
                            {% if user_profile.avatar %}
                                <img src="{{ user_profile.avatar.url }}" alt="{{ user.get_full_name }}" class="avatar-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="avatar-placeholder" style="display: none;">
                                    <span class="avatar-initials">{{ user.get_full_name|slice:":2"|upper|default:user.username|slice:":2"|upper }}</span>
                                </div>
                            {% else %}
                                <div class="avatar-placeholder">
                                    <span class="avatar-initials">{{ user.get_full_name|slice:":2"|upper|default:user.username|slice:":2"|upper }}</span>
                                </div>
                            {% endif %}
                            <div class="online-status"></div>
                        </div>
                        <div class="profile-details">
                            <h1 class="profile-name">{{ user.get_full_name|default:user.username }}</h1>
                            <p class="profile-username">@{{ user.username }}</p>
                            {% if user_profile.faculty %}
                                <div class="faculty-badge">
                                    <i class="fas fa-university me-2"></i>{{ user_profile.faculty.name }}
                                </div>
                            {% endif %}
                            <p class="profile-bio">{{ user_profile.bio|default:"No bio added yet." }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="profile-stats">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-number">{{ user_profile.total_downloads|default:0 }}</span>
                                <span class="stat-label">Downloads</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-upload"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-number">{{ user_profile.total_uploads|default:0 }}</span>
                                <span class="stat-label">Uploads</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-number">{{ user.date_joined|date:"M Y" }}</span>
                                <span class="stat-label">Member Since</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Content -->
    <div class="container py-5">
        <div class="row g-4">
            <!-- Left Column -->
            <div class="col-lg-8">
                <!-- Personal Information -->
                <div class="profile-section" data-aos="fade-up">
                    <div class="section-header">
                        <h3><i class="fas fa-user-circle me-2"></i>Personal Information</h3>
                        <button class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editProfileModal">
                            <i class="fas fa-edit me-1"></i>Edit
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-envelope"></i>Email
                                </div>
                                <div class="info-value">{{ user.email|default:"Not provided" }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-university"></i>Faculty
                                </div>
                                <div class="info-value">{{ user_profile.faculty.name|default:"Not selected" }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-calendar"></i>Date Joined
                                </div>
                                <div class="info-value">{{ user.date_joined|date:"F d, Y" }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-clock"></i>Last Login
                                </div>
                                <div class="info-value">{{ user.last_login|date:"F d, Y H:i"|default:"Never" }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subscription Status -->
                {% if user_profile.subscription %}
                <div class="profile-section" data-aos="fade-up" data-aos-delay="100">
                    <div class="section-header">
                        <h3><i class="fas fa-crown me-2"></i>Subscription Status</h3>
                    </div>
                    <div class="section-content">
                        <div class="subscription-card">
                            <div class="subscription-info">
                                <div class="subscription-type">
                                    <i class="fas fa-star"></i>
                                    {{ user_profile.subscription.get_subscription_type_display }}
                                </div>
                                <div class="subscription-details">
                                    <p>Started: {{ user_profile.subscription.start_date|date:"M d, Y" }}</p>
                                    <p>Expires: {{ user_profile.subscription.end_date|date:"M d, Y" }}</p>
                                    <p>Days Remaining: {{ user_profile.subscription.days_remaining }}</p>
                                </div>
                            </div>
                            <div class="subscription-status">
                                {% if user_profile.subscription.is_expiring_soon %}
                                    <span class="badge bg-warning">Expiring Soon</span>
                                {% elif user_profile.subscription.is_active %}
                                    <span class="badge bg-success">Active</span>
                                {% else %}
                                    <span class="badge bg-danger">Expired</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Recent Activity -->
                <div class="profile-section" data-aos="fade-up" data-aos-delay="200">
                    <div class="section-header">
                        <h3><i class="fas fa-history me-2"></i>Recent Activity</h3>
                    </div>
                    <div class="section-content">
                        <div class="activity-list">
                            {% for download in recent_downloads %}
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-download text-primary"></i>
                                </div>
                                <div class="activity-content">
                                    <div class="activity-title">Downloaded {{ download.content_type }}</div>
                                    <div class="activity-time">{{ download.downloaded_at|timesince }} ago</div>
                                </div>
                            </div>
                            {% empty %}
                            <div class="empty-activity">
                                <i class="fas fa-inbox fa-2x text-muted mb-3"></i>
                                <p class="text-muted">No recent activity</p>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="col-lg-4">
                <!-- Quick Actions -->
                <div class="profile-section" data-aos="fade-up" data-aos-delay="100">
                    <div class="section-header">
                        <h3><i class="fas fa-bolt me-2"></i>Quick Actions</h3>
                    </div>
                    <div class="section-content">
                        <div class="action-buttons">
                            <a href="{% url 'dashboard' %}" class="action-btn">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Dashboard</span>
                            </a>
                            <a href="{% url 'search' %}" class="action-btn">
                                <i class="fas fa-search"></i>
                                <span>Search Resources</span>
                            </a>
                            <a href="{% url 'contribute_resource' %}" class="action-btn">
                                <i class="fas fa-upload"></i>
                                <span>Upload Resource</span>
                            </a>
                            {% if not user_profile.is_contributor_approved %}
                            <a href="{% url 'contributor_request' %}" class="action-btn">
                                <i class="fas fa-user-plus"></i>
                                <span>Become Contributor</span>
                            </a>
                            {% endif %}
                            <a href="{% url 'subscription' %}" class="action-btn">
                                <i class="fas fa-crown"></i>
                                <span>Subscription</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Faculty Explorer -->
                <div class="profile-section" data-aos="fade-up" data-aos-delay="200">
                    <div class="section-header">
                        <h3><i class="fas fa-compass me-2"></i>Explore Faculties</h3>
                    </div>
                    <div class="section-content">
                        <div class="faculty-explorer">
                            {% for faculty in faculties %}
                            <a href="{% url 'faculty_overview' faculty.slug %}" class="faculty-explorer-item">
                                <div class="faculty-icon">
                                    {% if faculty.name == 'BSc CSIT' %}
                                        <i class="fas fa-laptop-code"></i>
                                    {% elif faculty.name == 'BBS' %}
                                        <i class="fas fa-chart-line"></i>
                                    {% elif faculty.name == 'BBA' %}
                                        <i class="fas fa-briefcase"></i>
                                    {% else %}
                                        <i class="fas fa-flask"></i>
                                    {% endif %}
                                </div>
                                <div class="faculty-info">
                                    <div class="faculty-name">{{ faculty.name }}</div>
                                    <div class="faculty-subjects">{{ faculty.subject_set.count }} subjects</div>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Account Settings -->
                <div class="profile-section" data-aos="fade-up" data-aos-delay="300">
                    <div class="section-header">
                        <h3><i class="fas fa-cog me-2"></i>Account Settings</h3>
                    </div>
                    <div class="section-content">
                        <div class="settings-list">
                            <a href="#" class="setting-item" onclick="changePassword()">
                                <i class="fas fa-key"></i>
                                <span>Change Password</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="setting-item" data-bs-toggle="modal" data-bs-target="#editProfileModal">
                                <i class="fas fa-user-edit"></i>
                                <span>Edit Profile</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="#" class="setting-item" onclick="notificationSettings()">
                                <i class="fas fa-bell"></i>
                                <span>Notifications</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'logout' %}" class="setting-item text-danger">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editProfileModalLabel">
                    <i class="fas fa-user-edit me-2"></i>Edit Profile
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="profileEditFormContainer">
                    <!-- Form will be loaded here via AJAX -->
                    <div class="text-center py-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2 text-muted">Loading form...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.profile-container {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
}

.profile-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 3rem 0;
    position: relative;
    overflow: hidden;
}

.profile-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    opacity: 0.3;
}

.profile-info {
    display: flex;
    align-items: center;
    position: relative;
    z-index: 2;
}

.profile-avatar {
    position: relative;
    margin-right: 2rem;
}

.avatar-img {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 4px solid rgba(255, 255, 255, 0.3);
    object-fit: cover;
}

.avatar-placeholder {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: white;
    border: 4px solid rgba(255, 255, 255, 0.3);
    font-weight: 600;
}

.avatar-initials {
    font-size: 2.5rem;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.online-status {
    position: absolute;
    bottom: 8px;
    right: 8px;
    width: 20px;
    height: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    border: 3px solid white;
}

.profile-name {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.profile-username {
    font-size: 1.1rem;
    opacity: 0.8;
    margin-bottom: 1rem;
}

.faculty-badge {
    display: inline-flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.2);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.profile-bio {
    font-size: 1rem;
    opacity: 0.9;
    line-height: 1.6;
    max-width: 500px;
}

.profile-stats {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
}

.stat-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 1rem;
    text-align: center;
    min-width: 100px;
}

.stat-icon {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    opacity: 0.8;
}

.stat-number {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.stat-label {
    font-size: 0.8rem;
    opacity: 0.8;
}

.profile-section {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
    overflow: hidden;
}

.section-header {
    display: flex;
    justify-content: between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #e2e8f0;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
}

.section-header h3 {
    margin: 0;
    color: #2d3748;
    font-weight: 600;
}

.section-content {
    padding: 1.5rem;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
}

.info-item {
    display: flex;
    flex-direction: column;
}

.info-label {
    display: flex;
    align-items: center;
    color: #718096;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.info-label i {
    margin-right: 0.5rem;
    color: #667eea;
}

.info-value {
    color: #2d3748;
    font-weight: 500;
}

.subscription-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 12px;
}

.subscription-type {
    display: flex;
    align-items: center;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.subscription-type i {
    margin-right: 0.5rem;
    color: #fbbf24;
}

.subscription-details p {
    margin: 0.25rem 0;
    font-size: 0.9rem;
    opacity: 0.9;
}

.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.action-btn {
    display: flex;
    align-items: center;
    padding: 1rem;
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    text-decoration: none;
    color: #4a5568;
    transition: all 0.3s ease;
}

.action-btn:hover {
    border-color: #667eea;
    background: #667eea;
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
}

.action-btn i {
    margin-right: 0.75rem;
    font-size: 1.1rem;
}

.faculty-explorer {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.faculty-explorer-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    text-decoration: none;
    color: #4a5568;
    transition: all 0.3s ease;
}

.faculty-explorer-item:hover {
    border-color: #667eea;
    background: #667eea;
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
}

.faculty-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    font-size: 1rem;
    color: white;
}

.faculty-info {
    flex: 1;
}

.faculty-name {
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.faculty-subjects {
    font-size: 0.8rem;
    opacity: 0.7;
}

.settings-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.setting-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    text-decoration: none;
    color: #4a5568;
    transition: all 0.3s ease;
}

.setting-item:hover {
    border-color: #667eea;
    background: #667eea;
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
}

.setting-item i:first-child {
    margin-right: 0.75rem;
    width: 20px;
}

.setting-item span {
    flex: 1;
}

.activity-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.activity-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 12px;
    border-left: 4px solid #667eea;
}

.activity-icon {
    margin-right: 1rem;
    font-size: 1.2rem;
}

.activity-content {
    flex: 1;
}

.activity-title {
    font-weight: 500;
    color: #2d3748;
    margin-bottom: 0.25rem;
}

.activity-time {
    font-size: 0.8rem;
    color: #718096;
}

.empty-activity {
    text-align: center;
    padding: 2rem;
    color: #718096;
}

@media (max-width: 768px) {
    .profile-info {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-avatar {
        margin-right: 0;
        margin-bottom: 1.5rem;
    }
    
    .profile-stats {
        justify-content: center;
        margin-top: 2rem;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
    }
    
    .subscription-card {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
}
</style>

<script>
// Profile Edit Modal Functionality
document.addEventListener('DOMContentLoaded', function() {
    const editProfileModal = document.getElementById('editProfileModal');
    const formContainer = document.getElementById('profileEditFormContainer');
    
    // Load form when modal is shown
    editProfileModal.addEventListener('show.bs.modal', function() {
        loadProfileEditForm();
    });
    
    // Handle form submission
    document.addEventListener('submit', function(e) {
        if (e.target.id === 'profileEditForm') {
            e.preventDefault();
            submitProfileForm(e.target);
        }
    });
});

function loadProfileEditForm() {
    const formContainer = document.getElementById('profileEditFormContainer');
    
    fetch('{% url "edit_profile" %}', {
        method: 'GET',
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.form_html) {
            formContainer.innerHTML = data.form_html;
        } else {
            formContainer.innerHTML = '<div class="alert alert-danger">No form data received.</div>';
        }
    })
    .catch(error => {
        console.error('Error loading form:', error);
        formContainer.innerHTML = '<div class="alert alert-danger">Error loading form. Please try again.</div>';
    });
}

function submitProfileForm(form) {
    const formData = new FormData(form);
    const submitBtn = document.getElementById('saveProfileBtn');
    const originalText = submitBtn.innerHTML;
    
    // Show loading state
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Saving...';
    submitBtn.disabled = true;
    
    // Get CSRF token
    const csrfToken = document.querySelector('meta[name=csrf-token]')?.getAttribute('content') ||
                     document.querySelector('[name=csrfmiddlewaretoken]')?.value;
    
    if (!csrfToken) {
        console.error('CSRF token not found');
        showAlert('danger', 'Security token not found. Please refresh the page and try again.');
        return;
    }
    
    fetch(form.dataset.url, {
        method: 'POST',
        body: formData,
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrfToken,
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Update profile information on the page
            updateProfileDisplay(data);
            
            // Show success message
            showAlert('success', data.message);
            
            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editProfileModal'));
            modal.hide();
        } else {
            // Show form errors
            showFormErrors(data.errors);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('danger', 'An error occurred. Please try again.');
    })
    .finally(() => {
        // Reset button state
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    });
}

function updateProfileDisplay(data) {
    // Update profile name
    const profileName = document.querySelector('.profile-name');
    if (profileName && data.user_name) {
        profileName.textContent = data.user_name;
    }
    
    // Update email
    const emailValue = document.querySelector('.info-value');
    if (emailValue && data.user_email) {
        // Find email field and update it
        const emailField = Array.from(document.querySelectorAll('.info-item')).find(item => 
            item.querySelector('.info-label').textContent.includes('Email')
        );
        if (emailField) {
            emailField.querySelector('.info-value').textContent = data.user_email;
        }
    }
    
    // Update faculty
    if (data.faculty_name) {
        const facultyField = Array.from(document.querySelectorAll('.info-item')).find(item => 
            item.querySelector('.info-label').textContent.includes('Faculty')
        );
        if (facultyField) {
            facultyField.querySelector('.info-value').textContent = data.faculty_name;
        }
    }
    
    // Update bio
    const profileBio = document.querySelector('.profile-bio');
    if (profileBio && data.bio) {
        profileBio.textContent = data.bio;
    }
    
    // Update avatar
    if (data.avatar_url) {
        const avatarImg = document.querySelector('.avatar-img');
        if (avatarImg) {
            avatarImg.src = data.avatar_url;
        } else {
            // Replace placeholder with image
            const avatarPlaceholder = document.querySelector('.avatar-placeholder');
            if (avatarPlaceholder) {
                const img = document.createElement('img');
                img.src = data.avatar_url;
                img.alt = 'Profile Picture';
                img.className = 'avatar-img';
                avatarPlaceholder.parentNode.replaceChild(img, avatarPlaceholder);
            }
        }
    }
}

function showFormErrors(errors) {
    // Clear previous errors
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
    document.querySelectorAll('.invalid-feedback').forEach(el => el.remove());
    
    // Show new errors
    Object.keys(errors).forEach(field => {
        const fieldElement = document.querySelector(`[name="${field}"]`);
        if (fieldElement) {
            fieldElement.classList.add('is-invalid');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'invalid-feedback';
            errorDiv.textContent = errors[field][0];
            fieldElement.parentNode.appendChild(errorDiv);
        }
    });
}

function showAlert(type, message) {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    // Insert at the top of the page
    const container = document.querySelector('.profile-container .container');
    container.insertBefore(alertDiv, container.firstChild);
    
    // Auto-dismiss after 5 seconds
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.remove();
        }
    }, 5000);
}

function changePassword() {
    // Implement password change functionality
    alert('Password change feature coming soon!');
}

function notificationSettings() {
    // Implement notification settings
    alert('Notification settings coming soon!');
}
</script>
{% endblock %} 